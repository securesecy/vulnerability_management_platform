import nmap

def scan_network(network_range):
    nm = nmap.PortScanner()
    nm.scan(network_range, arguments='-sV')
    
    vulnerabilities = []
    
    known_vulnerable_services = ['http', 'ftp', 'ssh']
    
    for host in nm.all_hosts():
        for proto in nm[host].all_protocols():
            lport = nm[host][proto].keys()
            for port in lport:
                service = nm[host][proto][port]['name']
                if service in known_vulnerable_services:
                    vulnerabilities.append({
                        'host': host,
                        'port': port,
                        'service': service,
                        'state': nm[host][proto][port]['state']
                    })
    return vulnerabilities

def main():
    network_range = input("Enter the IP address or network range to scan (e.g., '192.168.1.0/24'): ")
    vulnerabilities = scan_network(network_range)
    
    if vulnerabilities:
        print("Vulnerabilities found:")
        for vuln in vulnerabilities:
            print(f"Host: {vuln['host']}, Port: {vuln['port']}, Service: {vuln['service']}, State: {vuln['state']}")
    else:
        print("No known vulnerabilities found.")

if __name__ == "__main__":
    main()
